# ============================================
# Production Profile Configuration
# ============================================
spring.config.activate.on-profile=prod

# Production logging - structured JSON logging via logback-spring.xml
logging.level.root=INFO
logging.level.com.exploresg=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN

# File logging enabled in production
logging.file.path=/var/log/exploresg
logging.file.name=/var/log/exploresg/fleet-service.log

# Disable SQL logging in production
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Production database settings
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Hibernate Query Cache Configuration (prevent memory leaks)
spring.jpa.properties.hibernate.query.plan_cache_max_size=128
spring.jpa.properties.hibernate.query.plan_parameter_metadata_max_size=64

# Connection pool settings (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# Security headers
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# Actuator - restricted exposure
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.info.enabled=true

# Kubernetes Health Probes
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.endpoint.health.show-components=always
management.endpoint.health.group.liveness.include=livenessState
management.endpoint.health.group.readiness.include=readinessState,db

# Production CORS Configuration
cors.allowed-origins=https://www.xplore.town,https://xplore.town
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=Authorization,Content-Type
cors.allow-credentials=true

# SSL/TLS Configuration (uncomment when certificates are configured)
# server.ssl.enabled=true
# server.ssl.key-store=classpath:keystore.p12
# server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD}
# server.ssl.key-store-type=PKCS12
# server.ssl.key-alias=tomcat
